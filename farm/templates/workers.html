{% include "header.html" %}

<style>


  .top-left-btn {
    position: fixed;
    top: 100px;
    left: 20px;
    z-index: 1050;
    text-align: center;
  }

  .sell-label {
    font-weight: bold;
    font-size: 18px;
    margin-bottom: 5px;
    color: #333;
  }

  .toggle-switch {
    position: relative;
    display: inline-block;
    width: 70px;
    height: 34px;
  }

  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to right, #667eea, #764ba2);
    transition: 0.4s;
    border-radius: 34px;
  }

  .slider:before {
    position: absolute;
    content: "üë∑‚Äç‚ôÇÔ∏è";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    border-radius: 50%;
    transition: 0.4s;
    text-align: center;
    line-height: 26px;
    font-size: 14px;
  }

  .toggle-switch input:checked + .slider:before {
    transform: translateX(36px);
    content: "‚úîÔ∏è";
  }

.submit-btn {
  background: rgba(255, 0, 0, 0.61); /* translucent red */
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  font-weight: bold;
  border-radius: 30px;
  padding: 12px 30px;
  font-size: 16px;
  transition: all 0.3s ease;
  display: block;
  margin: 0 auto;  /* center horizontally */
  text-align: center;
}

.submit-btn:hover {
  background: rgba(255, 0, 0, 0.81);
  transform: scale(1.05);
}

  .file-selected-text {
    margin-top: 10px;
    font-size: 14px;
    color: #333;
  }

/* ========== Glassmorphic Upload Modal ========== */
.modal-content {
  background: rgba(255, 255, 255, 0.05);  /* light transparent layer */
  backdrop-filter: blur(14px);           /* glass blur effect */
  -webkit-backdrop-filter: blur(14px);   /* Safari support */
  border-radius: 20px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.37);
  color: #ffffff;
}

/* Modal Header with slight tint */
.modal-header {
  background: rgba(0, 216, 155, 0.4);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
  color: #fff;
}

/* Upload Card (form container) */
.upload-card {
  background: rgba(255, 255, 255, 0.03);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border-radius: 20px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  padding: 30px;
}

/* Input Fields */
.form-control {
  background: rgba(75, 238, 213, 0.13);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: #fff;
  border-radius: 12px;
  padding: 10px 14px;
}

.form-control::placeholder {
  color: rgba(255, 255, 255, 0.6);
}

label {
  color: #e0f7fa;
  font-weight: 600;
}

/* Upload Box */
.upload-box {
  background: rgba(255, 255, 255, 0.05);
  border: 2px dashed rgba(0, 188, 212, 0.6);
  backdrop-filter: blur(8px);
  color: #e0f7fa;
}

.upload-box:hover {
  background-color: rgba(0, 188, 212, 0.08);
  border-color: #00acc1;
}

.upload-box span {
  color: #fff;
}

.file-selected-text {
  color: #ffffff;
}


/* Optional: Darker Background Behind Modal */
.modal-backdrop.show {
  background-color: rgba(0, 0, 0, 0.5);
}

</style>

<!-- Toggle Button -->
<div class="top-left-btn">
  <div class="sell-label">Add Worker</div>
  <label class="toggle-switch">
    <input type="checkbox" data-bs-toggle="modal" data-bs-target="#workerModal">
    <span class="slider"></span>
  </label>
</div>

<!-- Modal -->
<div class="modal fade" id="workerModal" tabindex="-1" aria-labelledby="workerModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="workerModalLabel">Register Worker</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form method="POST" action="{% url 'workers' %}" enctype="multipart/form-data">
          {% csrf_token %}
          <input type="hidden" name="form_type" value="worker">

          <div class="upload-card container">
            <h4 class="text-center mb-4">Worker Details</h4>

            <div class="row mb-4">
              <div class="col-md-12">
                <label class="upload-box" id="uploadLabel">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <span>Click or drag to upload Worker Photo</span>
                  <input type="file" name="worker_image" id="formFileLg" accept="image/*" name="worker_image" onchange="updateFileName(this)" required>
                </label>
                <div class="file-selected-text text-center" id="file-name">No file selected</div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-7">
                <label>Worker Name</label>
                <input class="form-control" type="text" name="worker_name" required>
              </div>
              <div class="col-md-5">
                <label>Worker's Age</label>
                <input class="form-control" type="number" name="worker_age" required>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-7">
                <label>Working Job</label>
                <input class="form-control" type="text" name="working_job" required>
              </div>
              <div class="col-md-5">
                <label style="font-size:0.8rem;"> Working Duration(days)</label>
                <input class="form-control" type="text" name="working_duration" required>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-7">
                <label>Phone Number</label>
                <input class="form-control" type="text" name="worker_phone" required>
              </div>
              <div class="col-md-5">
                <label>Money to be paid</label>
                <input class="form-control" type="number" name="worker_payment" required>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-12">
                <label>Address</label>
                <input class="form-control" style="height:60px" type="text" name="worker_address" required>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-11">
                <button type="submit" class="submit-btn">Submit</button>
              </div>
            </div>

          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<style>
.monitiring{
    
   
}
.monitiring_text{
display:flex;
    align-item:center;
    justify-content:center;
}

.monitiring_video{
    display:flex;
    align-item:center;
    justify-content:center;
    
}



.display {
    height: 60px;
    width: 280px;
    font-size: 1.8rem;
    color: #fff;
    background: linear-gradient(135deg, #ff6a00, #ee0979); /* Vibrant gradient */
    border: none;
    border-radius: 50px;
    box-shadow: 0 0 15px rgba(255, 105, 180, 0.6), 0 0 5px rgba(255, 165, 0, 0.4);
    cursor: pointer;
    transition: all 0.3s ease-in-out;
    font-weight: bold;
    letter-spacing: 1px;
    text-transform: capitalize;
}

.display:hover {
    background: linear-gradient(135deg, #ee0979, #ff6a00); /* Gradient reverses on hover */
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(255, 105, 180, 0.8), 0 0 10px rgba(255, 165, 0, 0.6);
}
.delete-container {
  text-align: center;
}

.delete-btn {
  background-color: #e53935;
  color: white;
  border: none;
  padding: 10px 20px;
  font-size: 0.95rem;
  border-radius: 10px;
  cursor: pointer;
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
  box-shadow: 0 4px 10px rgba(229, 57, 53, 0.2);
}

.delete-btn:hover {
  background-color: #c62828;
  box-shadow: 0 6px 16px rgba(229, 57, 53, 0.35);
}


  .workers_card{
    height:450px;
    width: 300px;
 
    border-radius:16px;
  }

   .worker_card_body{

    height:300px;
    width: 100px;
  }


     .row1{
    width: 280px;
    padding-top:4px;
    margin:10px;
    font-size:0.99rem;
        font-weight:400;
  }

 .row2{
  
    width: 297px;
    height:40px;
display:flex;
  }

 .row3{
align-items:center;
justify-content:center;
  padding-left:100px;
  margin-top:10px;
  }



 .price{
    width: 100px;
display:flex;
justify-content:center;
align-items:center;
font-size:2rem;
        font-weight:600;
        color:green;
        margin-left:30px;
  }

   .details{
    width: 200px;
    font-size:0.7rem;
    padding-left:40px;
        font-weight:600;
  }



.worker_image{
      height:200px;
    width: 200px;
    border-radius:50%;  
    margin-left:25px;
    margin-top:10px;
    margin-bottom:8px;

}

.worker_name{
  font-size: 2rem;
  text-align:center;
      font-weight:700;
}

.workers_card {
  border-radius: 15px;
  transition: box-shadow 0.3s ease, transform 0.3s ease;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5); /* light shadow by default */
}

.workers_card:hover {
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.79); /* darker on hover */
  transform: translateY(-5px); /* slight lift on hover */
}

.show_worker{
position:fixed;
top:100px;
right:25px;

font-size:4rem;
}
.colorful-worker-form {
  width: 400px;
  margin: 30px auto;


}

.colorful-worker-form label {
  font-weight: bold;
  color: #333;
}

.worker-input {
  border-radius: 12px;
  padding: 10px;
  border: 1px solid #ccc;
  background: #fff;
  box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.05);
}

.detect-btn {
  background: #ff4d4d;
  color: white;
  font-weight: bold;
  border: none;
  border-radius: 25px;
  padding: 12px 30px;
  font-size: 16px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(255, 77, 77, 0.4);
}

.detect-btn:hover {
  background: #e60000;
  transform: scale(1.05);
}
/* Animation container */
#workerCardsContainer {
  opacity: 0;
  filter: blur(10px);
  transition: opacity 1s ease, filter 1s ease;
  display: none;
}

/* Show animation */
#workerCardsContainer.show-animate {
  display: block;
  opacity: 1;
  filter: blur(0);
}

/* Hide animation (optional delay for smooth exit) */
#workerCardsContainer.hide-animate {
  opacity: 0;
  filter: blur(10px);
  transition: opacity 0.8s ease, filter 0.8s ease;
}
.workers_card {
  opacity: 0;
  transform: translateY(20px);
  animation: fadeSlideIn 0.9s ease forwards;
  animation-delay: calc(0.3s);
  
}

@keyframes fadeSlideIn {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

</style>
 <!-- Add this in your workers page -->
<div class="monitoring-header-section">
  <div class="monitoring-title-wrapper">
<h1 class="monitoring-main-title">
  <i class="fas fa-user-clock" style="color: #3358b5ff;"></i>
Track Every Worker, Every Day üë∑
  <span class="instant-text">Instantly</span>
  <i class="fas fa-bolt" style="color: #ff9800;"></i>
</h1>

  </div>
</div>

<!-- Add this CSS in your style tag or CSS file -->
<style>
.monitoring-header-section {
  padding: 40px 20px;
  border-radius: 20px;
  text-align: center;
  animation: fadeInSlideUp 1s ease-in-out;
}



.monitoring-title-wrapper {
  animation: slideUp 1.2s ease-in-out;
}

.monitoring-main-title {
  font-size: 42px;
  font-weight: 800;
  color: #2e7d32;
  margin-bottom: 15px;
  animation: pulseText 2s infinite;
}

/* Animations */
@keyframes fadeInSlideUp {
  0% {
    opacity: 0;
    transform: translateY(40px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideUp {
  from {
    transform: translateY(30px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes pulseText {
  0%, 100% { color: #2e7d32; }
  50% { color: #66bb6a; }
}
</style>

<div class="monitiring">

<div class="monitiring_video">
  <div class="face-frame">
    <img src="{% url 'video_feed' %}" width="800" height="500" class="face-video">
    <div class="scanner-text">üîç Scanning for Workers...</div>
  </div>
</div>

<style>
.face-frame {
  position: relative;
  width: 800px;
  height: 500px;
  margin: auto;
  border: 4px solid transparent;
  border-radius: 15px;
  box-shadow: 0 0 0 3px #00e676 inset;
}

.face-video {
  border-radius: 15px;
  width: 100%;
  height: 100%;
  display: block;
}

/* Animated face detection corners */
.face-frame::before,
.face-frame::after {
  content: "";
  position: absolute;
  width: 30px;
  height: 30px;
  border: 3px solid #00e676;
  animation: cornerPulse 1.5s ease-in-out infinite;
}

.face-frame::before {
  top: 10px;
  left: 10px;
  border-right: none;
  border-bottom: none;
}

.face-frame::after {
  bottom: 10px;
  right: 10px;
  border-left: none;
  border-top: none;
}

@keyframes cornerPulse {
  0% { transform: scale(1); opacity: 0.8; }
  50% { transform: scale(1.3); opacity: 1; }
  100% { transform: scale(1); opacity: 0.8; }
}

/* Scanner Text */
.scanner-text {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 1.2rem;
  font-weight: bold;
  background: rgba(0, 0, 0, 0.6);
  color: #00e676;
  padding: 6px 14px;
  border-radius: 10px;
  animation: fadeInOut 3s ease-in-out infinite;
}

@keyframes fadeInOut {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}
</style>

  
</div></div>

<form method="GET" action="{% url 'workers' %}" class="colorful-worker-form">
  <div class="form-group mb-3">
    <label class="form-label">üë∑     Enter New Worker Name To Register In Database</label>
    <input class="form-control worker-input" type="text" name="new" required placeholder="e.g. Ramesh Kumar">
  </div>
  <div class="text-center">
    <button type="submit" name="start" value="true" class="btn detect-btn">üöÄ Start Face Detection</button>
  </div>
</form>





 <br>
 <br>


<i class="fa-solid show_worker fa-people-line" id="toggleWorkersBtn"></i>



<div id="workerCardsContainer" style="display: none;">

 <div class="container mt-4">
  <div class="row">
    {% for worker in data %}
    <div class="col-md-3 mb-4">
      <div class="workers_card">

        <div class="worker_card_top">
          <div class="worker_image">
            <img src="{{ worker.worker_image.url }}" class="worker_image">
          </div>
          <div class="worker_name">
            {{ worker.worker_name }}
          </div>
        </div>

        <div class="worker_card_body">
          <div class="row1">
           {{ worker.worker_name }} is {{ worker.worker_age }} Year Old and he is assigned for {{ worker.working_job }} for {{ worker.working_duration }} days
          </div>

          <div class="row2">
            <div class="price">
               ‚Çπ  {{ worker.worker_payment }}
            </div>
            <div class="details">
              <div class="phone">üìû Phone : {{ worker.worker_phone }}</div>
              <div class="address">üìçAddress : {{ worker.worker_address }}</div>
            </div>
          </div>

          <div class="row3">
            <form method="POST" onsubmit="return confirm('Are you sure you want to delete this worker?');">
              {% csrf_token %}
              <input type="hidden" name="delete_id" value="{{ worker.id }}">
              <button type="submit" class="delete-btn">Delete</button>
            </form>
          </div>
        </div>

      </div>
    </div>
    {% endfor %}
  </div>
</div>

</div>


    <script>
        const evtSource = new EventSource("{% url 'object_names_stream' %}");
        evtSource.onmessage = function(event) {
            const objectList = event.data.split(",");
            const listContainer = document.getElementById("object-list");
            listContainer.innerHTML = ""; // clear old list
            objectList.forEach(name => {
                if (name.trim() !== "") {
                    const li = document.createElement("h1");
                    li.textContent = name.trim();
                    listContainer.appendChild(li);
                }
            });
        };
    </script> 



<script>
  const toggleBtn = document.getElementById("toggleWorkersBtn");
  const workerContainer = document.getElementById("workerCardsContainer");

  let isVisible = false;

  toggleBtn.addEventListener("click", () => {
    if (!isVisible) {
      workerContainer.classList.remove("hide-animate");
      workerContainer.classList.add("show-animate");
      // Delay to ensure animation applies before display block
      setTimeout(() => {
        workerContainer.style.display = "block";
      }, 10);
    } else {
      workerContainer.classList.remove("show-animate");
      workerContainer.classList.add("hide-animate");
      setTimeout(() => {
        workerContainer.style.display = "none";
      }, 800); // match with transition time
    }
    isVisible = !isVisible;
  });
</script>




 <script>
  function updateFileName(input) {
    const fileName = input.files[0] ? input.files[0].name : "No file selected";
    document.getElementById("file-name").textContent = fileName;
  }
</script>

{% include "footer.html" %} 